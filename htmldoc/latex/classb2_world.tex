\hypertarget{classb2_world}{\section{b2\-World Class Reference}
\label{classb2_world}\index{b2\-World@{b2\-World}}
}


{\ttfamily \#include $<$b2\-World.\-h$>$}

\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classb2_world_aeccc87fd9e36702c821a8244ca7cd875}{b2\-World} (const \hyperlink{structb2_vec2}{b2\-Vec2} \&gravity)
\item 
\hypertarget{classb2_world_a5250ae4487475c33ccefdead07c768c8}{\hyperlink{classb2_world_a5250ae4487475c33ccefdead07c768c8}{$\sim$b2\-World} ()}\label{classb2_world_a5250ae4487475c33ccefdead07c768c8}

\begin{DoxyCompactList}\small\item\em Destruct the world. All physics entities are destroyed and all heap memory is released. \end{DoxyCompactList}\item 
void \hyperlink{classb2_world_ae377f2dd5512ada7d27f4ad3541c75bf}{Set\-Destruction\-Listener} (\hyperlink{classb2_destruction_listener}{b2\-Destruction\-Listener} $\ast$listener)
\item 
void \hyperlink{classb2_world_a85e6e1e911c7d6366f8c7d57a12b72ff}{Set\-Contact\-Filter} (\hyperlink{classb2_contact_filter}{b2\-Contact\-Filter} $\ast$filter)
\item 
void \hyperlink{classb2_world_a614549967fb8a1584b61c11e2d553d42}{Set\-Contact\-Listener} (\hyperlink{classb2_contact_listener}{b2\-Contact\-Listener} $\ast$listener)
\item 
void \hyperlink{classb2_world_a6976d2c67400df03c0d44174ffcfb7ee}{Set\-Debug\-Draw} (\hyperlink{classb2_draw}{b2\-Draw} $\ast$debug\-Draw)
\item 
\hyperlink{classb2_body}{b2\-Body} $\ast$ \hyperlink{classb2_world_a2eb36e967e43294bfa03ec3d177c2dae}{Create\-Body} (const \hyperlink{structb2_body_def}{b2\-Body\-Def} $\ast$def)
\item 
void \hyperlink{classb2_world_ad52231ad7a9556ef5735ac79cbcd8fcf}{Destroy\-Body} (\hyperlink{classb2_body}{b2\-Body} $\ast$body)
\item 
\hyperlink{classb2_joint}{b2\-Joint} $\ast$ \hyperlink{classb2_world_a5cba9d0653149eb62504154e6fb35021}{Create\-Joint} (const \hyperlink{structb2_joint_def}{b2\-Joint\-Def} $\ast$def)
\item 
void \hyperlink{classb2_world_add5942aef171e54cfa384c8975746dca}{Destroy\-Joint} (\hyperlink{classb2_joint}{b2\-Joint} $\ast$joint)
\item 
void \hyperlink{classb2_world_a7a8eff61af98461f978fe43f3af7be90}{Step} (float32 time\-Step, int32 velocity\-Iterations, int32 position\-Iterations)
\item 
void \hyperlink{classb2_world_ac082ab4c4ad0b1c5ec4674315eeec643}{Clear\-Forces} ()
\item 
\hypertarget{classb2_world_a293d9865e407fd463e168b0a29856acc}{void \hyperlink{classb2_world_a293d9865e407fd463e168b0a29856acc}{Draw\-Debug\-Data} ()}\label{classb2_world_a293d9865e407fd463e168b0a29856acc}

\begin{DoxyCompactList}\small\item\em Call this to draw shapes and other debug draw data. \end{DoxyCompactList}\item 
void \hyperlink{classb2_world_a711e55d2c6e68400f93472f807c3775b}{Query\-A\-A\-B\-B} (\hyperlink{classb2_query_callback}{b2\-Query\-Callback} $\ast$callback, const \hyperlink{structb2_a_a_b_b}{b2\-A\-A\-B\-B} \&aabb) const 
\item 
void \hyperlink{classb2_world_ad902548be84df9cc36eced0f4c89ab0a}{Ray\-Cast} (\hyperlink{classb2_ray_cast_callback}{b2\-Ray\-Cast\-Callback} $\ast$callback, const \hyperlink{structb2_vec2}{b2\-Vec2} \&point1, const \hyperlink{structb2_vec2}{b2\-Vec2} \&point2) const 
\item 
\hyperlink{classb2_body}{b2\-Body} $\ast$ \hyperlink{classb2_world_a1b87c03955e3312d308ddf679adf3c85}{Get\-Body\-List} ()
\item 
\hypertarget{classb2_world_ab7c43e574c60203db003645153663266}{const \hyperlink{classb2_body}{b2\-Body} $\ast$ {\bfseries Get\-Body\-List} () const }\label{classb2_world_ab7c43e574c60203db003645153663266}

\item 
\hyperlink{classb2_joint}{b2\-Joint} $\ast$ \hyperlink{classb2_world_a55db7240f8290aa02cab79f181934de8}{Get\-Joint\-List} ()
\item 
\hypertarget{classb2_world_a966ceb42d968a8a544d60826ce0ed925}{const \hyperlink{classb2_joint}{b2\-Joint} $\ast$ {\bfseries Get\-Joint\-List} () const }\label{classb2_world_a966ceb42d968a8a544d60826ce0ed925}

\item 
\hyperlink{classb2_contact}{b2\-Contact} $\ast$ \hyperlink{classb2_world_ab1e1c59fd7534c0268c2a3e31370a425}{Get\-Contact\-List} ()
\item 
\hypertarget{classb2_world_a15e9281350c0494954197801372e3dbb}{const \hyperlink{classb2_contact}{b2\-Contact} $\ast$ {\bfseries Get\-Contact\-List} () const }\label{classb2_world_a15e9281350c0494954197801372e3dbb}

\item 
\hypertarget{classb2_world_a6755872564fc3db70c69d2b9d349fa33}{void \hyperlink{classb2_world_a6755872564fc3db70c69d2b9d349fa33}{Set\-Allow\-Sleeping} (bool flag)}\label{classb2_world_a6755872564fc3db70c69d2b9d349fa33}

\begin{DoxyCompactList}\small\item\em Enable/disable sleep. \end{DoxyCompactList}\item 
\hypertarget{classb2_world_aaf98b836840452d646927ba19a02316f}{bool {\bfseries Get\-Allow\-Sleeping} () const }\label{classb2_world_aaf98b836840452d646927ba19a02316f}

\item 
\hypertarget{classb2_world_a8e8c12142e8c4884a18787926a261359}{void \hyperlink{classb2_world_a8e8c12142e8c4884a18787926a261359}{Set\-Warm\-Starting} (bool flag)}\label{classb2_world_a8e8c12142e8c4884a18787926a261359}

\begin{DoxyCompactList}\small\item\em Enable/disable warm starting. For testing. \end{DoxyCompactList}\item 
\hypertarget{classb2_world_af7679b68ff6bf97d31a6136efaee562e}{bool {\bfseries Get\-Warm\-Starting} () const }\label{classb2_world_af7679b68ff6bf97d31a6136efaee562e}

\item 
\hypertarget{classb2_world_a536dd9181c2e20096073e3cfe2c8530a}{void \hyperlink{classb2_world_a536dd9181c2e20096073e3cfe2c8530a}{Set\-Continuous\-Physics} (bool flag)}\label{classb2_world_a536dd9181c2e20096073e3cfe2c8530a}

\begin{DoxyCompactList}\small\item\em Enable/disable continuous physics. For testing. \end{DoxyCompactList}\item 
\hypertarget{classb2_world_aa11dbc1175a7a458e007722ab7287ff1}{bool {\bfseries Get\-Continuous\-Physics} () const }\label{classb2_world_aa11dbc1175a7a458e007722ab7287ff1}

\item 
\hypertarget{classb2_world_ae8aacc78ea4753075067daff51b61778}{void \hyperlink{classb2_world_ae8aacc78ea4753075067daff51b61778}{Set\-Sub\-Stepping} (bool flag)}\label{classb2_world_ae8aacc78ea4753075067daff51b61778}

\begin{DoxyCompactList}\small\item\em Enable/disable single stepped continuous physics. For testing. \end{DoxyCompactList}\item 
\hypertarget{classb2_world_ae3922f4935ad0dd7f85eea7550e18c5d}{bool {\bfseries Get\-Sub\-Stepping} () const }\label{classb2_world_ae3922f4935ad0dd7f85eea7550e18c5d}

\item 
\hypertarget{classb2_world_a67f1f9fbdd85abd2100104c5eabe17cb}{int32 \hyperlink{classb2_world_a67f1f9fbdd85abd2100104c5eabe17cb}{Get\-Proxy\-Count} () const }\label{classb2_world_a67f1f9fbdd85abd2100104c5eabe17cb}

\begin{DoxyCompactList}\small\item\em Get the number of broad-\/phase proxies. \end{DoxyCompactList}\item 
\hypertarget{classb2_world_a4559122ea51401b4fb7342eb6232ce74}{int32 \hyperlink{classb2_world_a4559122ea51401b4fb7342eb6232ce74}{Get\-Body\-Count} () const }\label{classb2_world_a4559122ea51401b4fb7342eb6232ce74}

\begin{DoxyCompactList}\small\item\em Get the number of bodies. \end{DoxyCompactList}\item 
\hypertarget{classb2_world_a54a95a98787ed5f383c6549ee1f4c4d5}{int32 \hyperlink{classb2_world_a54a95a98787ed5f383c6549ee1f4c4d5}{Get\-Joint\-Count} () const }\label{classb2_world_a54a95a98787ed5f383c6549ee1f4c4d5}

\begin{DoxyCompactList}\small\item\em Get the number of joints. \end{DoxyCompactList}\item 
\hypertarget{classb2_world_abcc976f1755f9bb94a8650f5f4219a8d}{int32 \hyperlink{classb2_world_abcc976f1755f9bb94a8650f5f4219a8d}{Get\-Contact\-Count} () const }\label{classb2_world_abcc976f1755f9bb94a8650f5f4219a8d}

\begin{DoxyCompactList}\small\item\em Get the number of contacts (each may have 0 or more contact points). \end{DoxyCompactList}\item 
\hypertarget{classb2_world_a48f90a31dc2ad30dbc50cac5111400d7}{int32 \hyperlink{classb2_world_a48f90a31dc2ad30dbc50cac5111400d7}{Get\-Tree\-Height} () const }\label{classb2_world_a48f90a31dc2ad30dbc50cac5111400d7}

\begin{DoxyCompactList}\small\item\em Get the height of the dynamic tree. \end{DoxyCompactList}\item 
\hypertarget{classb2_world_a9fb7c28d042b600ba1155e3d38f1c5f9}{int32 \hyperlink{classb2_world_a9fb7c28d042b600ba1155e3d38f1c5f9}{Get\-Tree\-Balance} () const }\label{classb2_world_a9fb7c28d042b600ba1155e3d38f1c5f9}

\begin{DoxyCompactList}\small\item\em Get the balance of the dynamic tree. \end{DoxyCompactList}\item 
float32 \hyperlink{classb2_world_a0e9dceab7052fd6e0d73d6024cca1bcb}{Get\-Tree\-Quality} () const 
\item 
\hypertarget{classb2_world_aeafa43d6580e1dddb0675e672ca2375c}{void \hyperlink{classb2_world_aeafa43d6580e1dddb0675e672ca2375c}{Set\-Gravity} (const \hyperlink{structb2_vec2}{b2\-Vec2} \&gravity)}\label{classb2_world_aeafa43d6580e1dddb0675e672ca2375c}

\begin{DoxyCompactList}\small\item\em Change the global gravity vector. \end{DoxyCompactList}\item 
\hypertarget{classb2_world_a1e34bcd2f75fbdd41e2d84b3eb26d1ab}{\hyperlink{structb2_vec2}{b2\-Vec2} \hyperlink{classb2_world_a1e34bcd2f75fbdd41e2d84b3eb26d1ab}{Get\-Gravity} () const }\label{classb2_world_a1e34bcd2f75fbdd41e2d84b3eb26d1ab}

\begin{DoxyCompactList}\small\item\em Get the global gravity vector. \end{DoxyCompactList}\item 
\hypertarget{classb2_world_ae50c318304546c9cc066ee382668c4a1}{bool \hyperlink{classb2_world_ae50c318304546c9cc066ee382668c4a1}{Is\-Locked} () const }\label{classb2_world_ae50c318304546c9cc066ee382668c4a1}

\begin{DoxyCompactList}\small\item\em Is the world locked (in the middle of a time step). \end{DoxyCompactList}\item 
\hypertarget{classb2_world_aa2bced28ddef5bbb00ed5666e5e9f620}{void \hyperlink{classb2_world_aa2bced28ddef5bbb00ed5666e5e9f620}{Set\-Auto\-Clear\-Forces} (bool flag)}\label{classb2_world_aa2bced28ddef5bbb00ed5666e5e9f620}

\begin{DoxyCompactList}\small\item\em Set flag to control automatic clearing of forces after each time step. \end{DoxyCompactList}\item 
\hypertarget{classb2_world_af56cc43ebde27946ed39382b4ea31640}{bool \hyperlink{classb2_world_af56cc43ebde27946ed39382b4ea31640}{Get\-Auto\-Clear\-Forces} () const }\label{classb2_world_af56cc43ebde27946ed39382b4ea31640}

\begin{DoxyCompactList}\small\item\em Get the flag that controls automatic clearing of forces after each time step. \end{DoxyCompactList}\item 
\hypertarget{classb2_world_a16259159ae1719c30808561c990a8c05}{const \hyperlink{classb2_contact_manager}{b2\-Contact\-Manager} \& \hyperlink{classb2_world_a16259159ae1719c30808561c990a8c05}{Get\-Contact\-Manager} () const }\label{classb2_world_a16259159ae1719c30808561c990a8c05}

\begin{DoxyCompactList}\small\item\em Get the contact manager for testing. \end{DoxyCompactList}\item 
\hypertarget{classb2_world_af41b3f1a21efc854b485d311911e24b2}{const \hyperlink{structb2_profile}{b2\-Profile} \& \hyperlink{classb2_world_af41b3f1a21efc854b485d311911e24b2}{Get\-Profile} () const }\label{classb2_world_af41b3f1a21efc854b485d311911e24b2}

\begin{DoxyCompactList}\small\item\em Get the current profile. \end{DoxyCompactList}\item 
void \hyperlink{classb2_world_a73c1fec260d460514edd335d4c235893}{Dump} ()
\end{DoxyCompactItemize}
\subsection*{Friends}
\begin{DoxyCompactItemize}
\item 
\hypertarget{classb2_world_a010ab52de250e5fe30a45d642f46405b}{class {\bfseries b2\-Body}}\label{classb2_world_a010ab52de250e5fe30a45d642f46405b}

\item 
\hypertarget{classb2_world_afb35b0e61f6ee3cc516c40ea251f3236}{class {\bfseries b2\-Fixture}}\label{classb2_world_afb35b0e61f6ee3cc516c40ea251f3236}

\item 
\hypertarget{classb2_world_aece264d42f69aed410f5eb3beba6ddf2}{class {\bfseries b2\-Contact\-Manager}}\label{classb2_world_aece264d42f69aed410f5eb3beba6ddf2}

\item 
\hypertarget{classb2_world_ad0171f9dac44cc7aae065c618c0d165b}{class {\bfseries b2\-Controller}}\label{classb2_world_ad0171f9dac44cc7aae065c618c0d165b}

\end{DoxyCompactItemize}


\subsection{Detailed Description}
The world class manages all physics entities, dynamic simulation, and asynchronous queries. The world also contains efficient memory management facilities. 

\subsection{Constructor \& Destructor Documentation}
\hypertarget{classb2_world_aeccc87fd9e36702c821a8244ca7cd875}{\index{b2\-World@{b2\-World}!b2\-World@{b2\-World}}
\index{b2\-World@{b2\-World}!b2World@{b2\-World}}
\subsubsection[{b2\-World}]{\setlength{\rightskip}{0pt plus 5cm}{\bf b2\-World\-::b2\-World} (
\begin{DoxyParamCaption}
\item[{const {\bf b2\-Vec2} \&}]{gravity}
\end{DoxyParamCaption}
)}}\label{classb2_world_aeccc87fd9e36702c821a8244ca7cd875}
Construct a world object. 
\begin{DoxyParams}{Parameters}
{\em gravity} & the world gravity vector. \\
\hline
\end{DoxyParams}

\begin{DoxyCode}
{
        m_destructionListener = NULL;
        m_debugDraw = NULL;

        m_bodyList = NULL;
        m_jointList = NULL;

        m_bodyCount = 0;
        m_jointCount = 0;

        m_warmStarting = true;
        m_continuousPhysics = true;
        m_subStepping = false;

        m_stepComplete = true;

        m_allowSleep = true;
        m_gravity = gravity;

        m_flags = e_clearForces;

        m_inv_dt0 = 0.0f;

        m_contactManager.m_allocator = &m_blockAllocator;

        memset(&m_profile, 0, sizeof(b2Profile));
}
\end{DoxyCode}


\subsection{Member Function Documentation}
\hypertarget{classb2_world_ac082ab4c4ad0b1c5ec4674315eeec643}{\index{b2\-World@{b2\-World}!Clear\-Forces@{Clear\-Forces}}
\index{Clear\-Forces@{Clear\-Forces}!b2World@{b2\-World}}
\subsubsection[{Clear\-Forces}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf b2\-World\-::\-Clear\-Forces} (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classb2_world_ac082ab4c4ad0b1c5ec4674315eeec643}
Manually clear the force buffer on all bodies. By default, forces are cleared automatically after each call to Step. The default behavior is modified by calling Set\-Auto\-Clear\-Forces. The purpose of this function is to support sub-\/stepping. Sub-\/stepping is often used to maintain a fixed sized time step under a variable frame-\/rate. When you perform sub-\/stepping you will disable auto clearing of forces and instead call Clear\-Forces after all sub-\/steps are complete in one pass of your game loop. \begin{DoxySeeAlso}{See also}
\hyperlink{classb2_world_aa2bced28ddef5bbb00ed5666e5e9f620}{Set\-Auto\-Clear\-Forces} 
\end{DoxySeeAlso}


Referenced by Step().


\begin{DoxyCode}
{
        for (b2Body* body = m_bodyList; body; body = body->GetNext())
        {
                body->m_force.SetZero();
                body->m_torque = 0.0f;
        }
}
\end{DoxyCode}
\hypertarget{classb2_world_a2eb36e967e43294bfa03ec3d177c2dae}{\index{b2\-World@{b2\-World}!Create\-Body@{Create\-Body}}
\index{Create\-Body@{Create\-Body}!b2World@{b2\-World}}
\subsubsection[{Create\-Body}]{\setlength{\rightskip}{0pt plus 5cm}{\bf b2\-Body} $\ast$ {\bf b2\-World\-::\-Create\-Body} (
\begin{DoxyParamCaption}
\item[{const {\bf b2\-Body\-Def} $\ast$}]{def}
\end{DoxyParamCaption}
)}}\label{classb2_world_a2eb36e967e43294bfa03ec3d177c2dae}
Create a rigid body given a definition. No reference to the definition is retained. \begin{DoxyWarning}{Warning}
This function is locked during callbacks. 
\end{DoxyWarning}

\begin{DoxyCode}
{
        b2Assert(IsLocked() == false);
        if (IsLocked())
        {
                return NULL;
        }

        void* mem = m_blockAllocator.Allocate(sizeof(b2Body));
        b2Body* b = new (mem) b2Body(def, this);

        // Add to world doubly linked list.
        b->m_prev = NULL;
        b->m_next = m_bodyList;
        if (m_bodyList)
        {
                m_bodyList->m_prev = b;
        }
        m_bodyList = b;
        ++m_bodyCount;

        return b;
}
\end{DoxyCode}
\hypertarget{classb2_world_a5cba9d0653149eb62504154e6fb35021}{\index{b2\-World@{b2\-World}!Create\-Joint@{Create\-Joint}}
\index{Create\-Joint@{Create\-Joint}!b2World@{b2\-World}}
\subsubsection[{Create\-Joint}]{\setlength{\rightskip}{0pt plus 5cm}{\bf b2\-Joint} $\ast$ {\bf b2\-World\-::\-Create\-Joint} (
\begin{DoxyParamCaption}
\item[{const {\bf b2\-Joint\-Def} $\ast$}]{def}
\end{DoxyParamCaption}
)}}\label{classb2_world_a5cba9d0653149eb62504154e6fb35021}
Create a joint to constrain bodies together. No reference to the definition is retained. This may cause the connected bodies to cease colliding. \begin{DoxyWarning}{Warning}
This function is locked during callbacks. 
\end{DoxyWarning}

\begin{DoxyCode}
{
        b2Assert(IsLocked() == false);
        if (IsLocked())
        {
                return NULL;
        }

        b2Joint* j = b2Joint::Create(def, &m_blockAllocator);

        // Connect to the world list.
        j->m_prev = NULL;
        j->m_next = m_jointList;
        if (m_jointList)
        {
                m_jointList->m_prev = j;
        }
        m_jointList = j;
        ++m_jointCount;

        // Connect to the bodies' doubly linked lists.
        j->m_edgeA.joint = j;
        j->m_edgeA.other = j->m_bodyB;
        j->m_edgeA.prev = NULL;
        j->m_edgeA.next = j->m_bodyA->m_jointList;
        if (j->m_bodyA->m_jointList) j->m_bodyA->m_jointList->prev = &j->
      m_edgeA;
        j->m_bodyA->m_jointList = &j->m_edgeA;

        j->m_edgeB.joint = j;
        j->m_edgeB.other = j->m_bodyA;
        j->m_edgeB.prev = NULL;
        j->m_edgeB.next = j->m_bodyB->m_jointList;
        if (j->m_bodyB->m_jointList) j->m_bodyB->m_jointList->prev = &j->
      m_edgeB;
        j->m_bodyB->m_jointList = &j->m_edgeB;

        b2Body* bodyA = def->bodyA;
        b2Body* bodyB = def->bodyB;

        // If the joint prevents collisions, then flag any contacts for
       filtering.
        if (def->collideConnected == false)
        {
                b2ContactEdge* edge = bodyB->GetContactList();
                while (edge)
                {
                        if (edge->other == bodyA)
                        {
                                // Flag the contact for filtering at the next
       time step (where either
                                // body is awake).
                                edge->contact->FlagForFiltering();
                        }

                        edge = edge->next;
                }
        }

        // Note: creating a joint doesn't wake the bodies.

        return j;
}
\end{DoxyCode}
\hypertarget{classb2_world_ad52231ad7a9556ef5735ac79cbcd8fcf}{\index{b2\-World@{b2\-World}!Destroy\-Body@{Destroy\-Body}}
\index{Destroy\-Body@{Destroy\-Body}!b2World@{b2\-World}}
\subsubsection[{Destroy\-Body}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf b2\-World\-::\-Destroy\-Body} (
\begin{DoxyParamCaption}
\item[{{\bf b2\-Body} $\ast$}]{body}
\end{DoxyParamCaption}
)}}\label{classb2_world_ad52231ad7a9556ef5735ac79cbcd8fcf}
Destroy a rigid body given a definition. No reference to the definition is retained. This function is locked during callbacks. \begin{DoxyWarning}{Warning}
This automatically deletes all associated shapes and joints. 

This function is locked during callbacks. 
\end{DoxyWarning}

\begin{DoxyCode}
{
        b2Assert(m_bodyCount > 0);
        b2Assert(IsLocked() == false);
        if (IsLocked())
        {
                return;
        }

        // Delete the attached joints.
        b2JointEdge* je = b->m_jointList;
        while (je)
        {
                b2JointEdge* je0 = je;
                je = je->next;

                if (m_destructionListener)
                {
                        m_destructionListener->SayGoodbye(je0->joint);
                }

                DestroyJoint(je0->joint);

                b->m_jointList = je;
        }
        b->m_jointList = NULL;

        // Delete the attached contacts.
        b2ContactEdge* ce = b->m_contactList;
        while (ce)
        {
                b2ContactEdge* ce0 = ce;
                ce = ce->next;
                m_contactManager.Destroy(ce0->contact);
        }
        b->m_contactList = NULL;

        // Delete the attached fixtures. This destroys broad-phase proxies.
        b2Fixture* f = b->m_fixtureList;
        while (f)
        {
                b2Fixture* f0 = f;
                f = f->m_next;

                if (m_destructionListener)
                {
                        m_destructionListener->SayGoodbye(f0);
                }

                f0->DestroyProxies(&m_contactManager.m_broadPhase);
                f0->Destroy(&m_blockAllocator);
                f0->~b2Fixture();
                m_blockAllocator.Free(f0, sizeof(b2Fixture));

                b->m_fixtureList = f;
                b->m_fixtureCount -= 1;
        }
        b->m_fixtureList = NULL;
        b->m_fixtureCount = 0;

        // Remove world body list.
        if (b->m_prev)
        {
                b->m_prev->m_next = b->m_next;
        }

        if (b->m_next)
        {
                b->m_next->m_prev = b->m_prev;
        }

        if (b == m_bodyList)
        {
                m_bodyList = b->m_next;
        }

        --m_bodyCount;
        b->~b2Body();
        m_blockAllocator.Free(b, sizeof(b2Body));
}
\end{DoxyCode}
\hypertarget{classb2_world_add5942aef171e54cfa384c8975746dca}{\index{b2\-World@{b2\-World}!Destroy\-Joint@{Destroy\-Joint}}
\index{Destroy\-Joint@{Destroy\-Joint}!b2World@{b2\-World}}
\subsubsection[{Destroy\-Joint}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf b2\-World\-::\-Destroy\-Joint} (
\begin{DoxyParamCaption}
\item[{{\bf b2\-Joint} $\ast$}]{joint}
\end{DoxyParamCaption}
)}}\label{classb2_world_add5942aef171e54cfa384c8975746dca}
Destroy a joint. This may cause the connected bodies to begin colliding. \begin{DoxyWarning}{Warning}
This function is locked during callbacks. 
\end{DoxyWarning}


Referenced by Destroy\-Body().


\begin{DoxyCode}
{
        b2Assert(IsLocked() == false);
        if (IsLocked())
        {
                return;
        }

        bool collideConnected = j->m_collideConnected;

        // Remove from the doubly linked list.
        if (j->m_prev)
        {
                j->m_prev->m_next = j->m_next;
        }

        if (j->m_next)
        {
                j->m_next->m_prev = j->m_prev;
        }

        if (j == m_jointList)
        {
                m_jointList = j->m_next;
        }

        // Disconnect from island graph.
        b2Body* bodyA = j->m_bodyA;
        b2Body* bodyB = j->m_bodyB;

        // Wake up connected bodies.
        bodyA->SetAwake(true);
        bodyB->SetAwake(true);

        // Remove from body 1.
        if (j->m_edgeA.prev)
        {
                j->m_edgeA.prev->next = j->m_edgeA.next;
        }

        if (j->m_edgeA.next)
        {
                j->m_edgeA.next->prev = j->m_edgeA.prev;
        }

        if (&j->m_edgeA == bodyA->m_jointList)
        {
                bodyA->m_jointList = j->m_edgeA.next;
        }

        j->m_edgeA.prev = NULL;
        j->m_edgeA.next = NULL;

        // Remove from body 2
        if (j->m_edgeB.prev)
        {
                j->m_edgeB.prev->next = j->m_edgeB.next;
        }

        if (j->m_edgeB.next)
        {
                j->m_edgeB.next->prev = j->m_edgeB.prev;
        }

        if (&j->m_edgeB == bodyB->m_jointList)
        {
                bodyB->m_jointList = j->m_edgeB.next;
        }

        j->m_edgeB.prev = NULL;
        j->m_edgeB.next = NULL;

        b2Joint::Destroy(j, &m_blockAllocator);

        b2Assert(m_jointCount > 0);
        --m_jointCount;

        // If the joint prevents collisions, then flag any contacts for
       filtering.
        if (collideConnected == false)
        {
                b2ContactEdge* edge = bodyB->GetContactList();
                while (edge)
                {
                        if (edge->other == bodyA)
                        {
                                // Flag the contact for filtering at the next
       time step (where either
                                // body is awake).
                                edge->contact->FlagForFiltering();
                        }

                        edge = edge->next;
                }
        }
}
\end{DoxyCode}
\hypertarget{classb2_world_a73c1fec260d460514edd335d4c235893}{\index{b2\-World@{b2\-World}!Dump@{Dump}}
\index{Dump@{Dump}!b2World@{b2\-World}}
\subsubsection[{Dump}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf b2\-World\-::\-Dump} (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classb2_world_a73c1fec260d460514edd335d4c235893}
Dump the world into the log file. \begin{DoxyWarning}{Warning}
this should be called outside of a time step. 
\end{DoxyWarning}

\begin{DoxyCode}
{
        if ((m_flags & e_locked) == e_locked)
        {
                return;
        }

        b2Log("b2Vec2 g(%.15lef, %.15lef);\n", m_gravity.x, m_gravity.y);
        b2Log("m_world->SetGravity(g);\n");

        b2Log("b2Body** bodies = (b2Body**)b2Alloc(%d * sizeof(b2Body*));\n", 
      m_bodyCount);
        b2Log("b2Joint** joints = (b2Joint**)b2Alloc(%d * sizeof(b2Joint*));\n"
      , m_jointCount);
        int32 i = 0;
        for (b2Body* b = m_bodyList; b; b = b->m_next)
        {
                b->m_islandIndex = i;
                b->Dump();
                ++i;
        }

        i = 0;
        for (b2Joint* j = m_jointList; j; j = j->m_next)
        {
                j->m_index = i;
                ++i;
        }

        // First pass on joints, skip gear joints.
        for (b2Joint* j = m_jointList; j; j = j->m_next)
        {
                if (j->m_type == e_gearJoint)
                {
                        continue;
                }

                b2Log("{\n");
                j->Dump();
                b2Log("}\n");
        }

        // Second pass on joints, only gear joints.
        for (b2Joint* j = m_jointList; j; j = j->m_next)
        {
                if (j->m_type != e_gearJoint)
                {
                        continue;
                }

                b2Log("{\n");
                j->Dump();
                b2Log("}\n");
        }

        b2Log("b2Free(joints);\n");
        b2Log("b2Free(bodies);\n");
        b2Log("joints = NULL;\n");
        b2Log("bodies = NULL;\n");
}
\end{DoxyCode}
\hypertarget{classb2_world_a1b87c03955e3312d308ddf679adf3c85}{\index{b2\-World@{b2\-World}!Get\-Body\-List@{Get\-Body\-List}}
\index{Get\-Body\-List@{Get\-Body\-List}!b2World@{b2\-World}}
\subsubsection[{Get\-Body\-List}]{\setlength{\rightskip}{0pt plus 5cm}{\bf b2\-Body} $\ast$ {\bf b2\-World\-::\-Get\-Body\-List} (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}\label{classb2_world_a1b87c03955e3312d308ddf679adf3c85}
Get the world body list. With the returned body, use \hyperlink{classb2_body_ad54182a11d02362b027a0eb072775bdc}{b2\-Body\-::\-Get\-Next} to get the next body in the world list. A N\-U\-L\-L body indicates the end of the list. \begin{DoxyReturn}{Returns}
the head of the world body list. 
\end{DoxyReturn}

\begin{DoxyCode}
{
        return m_bodyList;
}
\end{DoxyCode}
\hypertarget{classb2_world_ab1e1c59fd7534c0268c2a3e31370a425}{\index{b2\-World@{b2\-World}!Get\-Contact\-List@{Get\-Contact\-List}}
\index{Get\-Contact\-List@{Get\-Contact\-List}!b2World@{b2\-World}}
\subsubsection[{Get\-Contact\-List}]{\setlength{\rightskip}{0pt plus 5cm}{\bf b2\-Contact} $\ast$ {\bf b2\-World\-::\-Get\-Contact\-List} (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}\label{classb2_world_ab1e1c59fd7534c0268c2a3e31370a425}
Get the world contact list. With the returned contact, use \hyperlink{classb2_contact_aebfebb1e4b27dc0bd7aa120093e3d650}{b2\-Contact\-::\-Get\-Next} to get the next contact in the world list. A N\-U\-L\-L contact indicates the end of the list. \begin{DoxyReturn}{Returns}
the head of the world contact list. 
\end{DoxyReturn}
\begin{DoxyWarning}{Warning}
contacts are created and destroyed in the middle of a time step. Use \hyperlink{classb2_contact_listener}{b2\-Contact\-Listener} to avoid missing contacts. 
\end{DoxyWarning}

\begin{DoxyCode}
{
        return m_contactManager.m_contactList;
}
\end{DoxyCode}
\hypertarget{classb2_world_a55db7240f8290aa02cab79f181934de8}{\index{b2\-World@{b2\-World}!Get\-Joint\-List@{Get\-Joint\-List}}
\index{Get\-Joint\-List@{Get\-Joint\-List}!b2World@{b2\-World}}
\subsubsection[{Get\-Joint\-List}]{\setlength{\rightskip}{0pt plus 5cm}{\bf b2\-Joint} $\ast$ {\bf b2\-World\-::\-Get\-Joint\-List} (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}\label{classb2_world_a55db7240f8290aa02cab79f181934de8}
Get the world joint list. With the returned joint, use \hyperlink{classb2_joint_a1a0e2137b631010750c728cb4e276e5d}{b2\-Joint\-::\-Get\-Next} to get the next joint in the world list. A N\-U\-L\-L joint indicates the end of the list. \begin{DoxyReturn}{Returns}
the head of the world joint list. 
\end{DoxyReturn}

\begin{DoxyCode}
{
        return m_jointList;
}
\end{DoxyCode}
\hypertarget{classb2_world_a0e9dceab7052fd6e0d73d6024cca1bcb}{\index{b2\-World@{b2\-World}!Get\-Tree\-Quality@{Get\-Tree\-Quality}}
\index{Get\-Tree\-Quality@{Get\-Tree\-Quality}!b2World@{b2\-World}}
\subsubsection[{Get\-Tree\-Quality}]{\setlength{\rightskip}{0pt plus 5cm}float32 {\bf b2\-World\-::\-Get\-Tree\-Quality} (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const}}\label{classb2_world_a0e9dceab7052fd6e0d73d6024cca1bcb}
Get the quality metric of the dynamic tree. The smaller the better. The minimum is 1. 
\begin{DoxyCode}
{
        return m_contactManager.m_broadPhase.GetTreeQuality();
}
\end{DoxyCode}
\hypertarget{classb2_world_a711e55d2c6e68400f93472f807c3775b}{\index{b2\-World@{b2\-World}!Query\-A\-A\-B\-B@{Query\-A\-A\-B\-B}}
\index{Query\-A\-A\-B\-B@{Query\-A\-A\-B\-B}!b2World@{b2\-World}}
\subsubsection[{Query\-A\-A\-B\-B}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf b2\-World\-::\-Query\-A\-A\-B\-B} (
\begin{DoxyParamCaption}
\item[{{\bf b2\-Query\-Callback} $\ast$}]{callback, }
\item[{const {\bf b2\-A\-A\-B\-B} \&}]{aabb}
\end{DoxyParamCaption}
) const}}\label{classb2_world_a711e55d2c6e68400f93472f807c3775b}
Query the world for all fixtures that potentially overlap the provided A\-A\-B\-B. 
\begin{DoxyParams}{Parameters}
{\em callback} & a user implemented callback class. \\
\hline
{\em aabb} & the query box. \\
\hline
\end{DoxyParams}

\begin{DoxyCode}
{
        b2WorldQueryWrapper wrapper;
        wrapper.broadPhase = &m_contactManager.m_broadPhase;
        wrapper.callback = callback;
        m_contactManager.m_broadPhase.Query(&wrapper, aabb);
}
\end{DoxyCode}
\hypertarget{classb2_world_ad902548be84df9cc36eced0f4c89ab0a}{\index{b2\-World@{b2\-World}!Ray\-Cast@{Ray\-Cast}}
\index{Ray\-Cast@{Ray\-Cast}!b2World@{b2\-World}}
\subsubsection[{Ray\-Cast}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf b2\-World\-::\-Ray\-Cast} (
\begin{DoxyParamCaption}
\item[{{\bf b2\-Ray\-Cast\-Callback} $\ast$}]{callback, }
\item[{const {\bf b2\-Vec2} \&}]{point1, }
\item[{const {\bf b2\-Vec2} \&}]{point2}
\end{DoxyParamCaption}
) const}}\label{classb2_world_ad902548be84df9cc36eced0f4c89ab0a}
Ray-\/cast the world for all fixtures in the path of the ray. Your callback controls whether you get the closest point, any point, or n-\/points. The ray-\/cast ignores shapes that contain the starting point. 
\begin{DoxyParams}{Parameters}
{\em callback} & a user implemented callback class. \\
\hline
{\em point1} & the ray starting point \\
\hline
{\em point2} & the ray ending point \\
\hline
\end{DoxyParams}

\begin{DoxyCode}
{
        b2WorldRayCastWrapper wrapper;
        wrapper.broadPhase = &m_contactManager.m_broadPhase;
        wrapper.callback = callback;
        b2RayCastInput input;
        input.maxFraction = 1.0f;
        input.p1 = point1;
        input.p2 = point2;
        m_contactManager.m_broadPhase.RayCast(&wrapper, input);
}
\end{DoxyCode}
\hypertarget{classb2_world_a85e6e1e911c7d6366f8c7d57a12b72ff}{\index{b2\-World@{b2\-World}!Set\-Contact\-Filter@{Set\-Contact\-Filter}}
\index{Set\-Contact\-Filter@{Set\-Contact\-Filter}!b2World@{b2\-World}}
\subsubsection[{Set\-Contact\-Filter}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf b2\-World\-::\-Set\-Contact\-Filter} (
\begin{DoxyParamCaption}
\item[{{\bf b2\-Contact\-Filter} $\ast$}]{filter}
\end{DoxyParamCaption}
)}}\label{classb2_world_a85e6e1e911c7d6366f8c7d57a12b72ff}
Register a contact filter to provide specific control over collision. Otherwise the default filter is used (b2\-\_\-default\-Filter). The listener is owned by you and must remain in scope. 
\begin{DoxyCode}
{
        m_contactManager.m_contactFilter = filter;
}
\end{DoxyCode}
\hypertarget{classb2_world_a614549967fb8a1584b61c11e2d553d42}{\index{b2\-World@{b2\-World}!Set\-Contact\-Listener@{Set\-Contact\-Listener}}
\index{Set\-Contact\-Listener@{Set\-Contact\-Listener}!b2World@{b2\-World}}
\subsubsection[{Set\-Contact\-Listener}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf b2\-World\-::\-Set\-Contact\-Listener} (
\begin{DoxyParamCaption}
\item[{{\bf b2\-Contact\-Listener} $\ast$}]{listener}
\end{DoxyParamCaption}
)}}\label{classb2_world_a614549967fb8a1584b61c11e2d553d42}
Register a contact event listener. The listener is owned by you and must remain in scope. 
\begin{DoxyCode}
{
        m_contactManager.m_contactListener = listener;
}
\end{DoxyCode}
\hypertarget{classb2_world_a6976d2c67400df03c0d44174ffcfb7ee}{\index{b2\-World@{b2\-World}!Set\-Debug\-Draw@{Set\-Debug\-Draw}}
\index{Set\-Debug\-Draw@{Set\-Debug\-Draw}!b2World@{b2\-World}}
\subsubsection[{Set\-Debug\-Draw}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf b2\-World\-::\-Set\-Debug\-Draw} (
\begin{DoxyParamCaption}
\item[{{\bf b2\-Draw} $\ast$}]{debug\-Draw}
\end{DoxyParamCaption}
)}}\label{classb2_world_a6976d2c67400df03c0d44174ffcfb7ee}
Register a routine for debug drawing. The debug draw functions are called inside with \hyperlink{classb2_world_a293d9865e407fd463e168b0a29856acc}{b2\-World\-::\-Draw\-Debug\-Data} method. The debug draw object is owned by you and must remain in scope. 
\begin{DoxyCode}
{
        m_debugDraw = debugDraw;
}
\end{DoxyCode}
\hypertarget{classb2_world_ae377f2dd5512ada7d27f4ad3541c75bf}{\index{b2\-World@{b2\-World}!Set\-Destruction\-Listener@{Set\-Destruction\-Listener}}
\index{Set\-Destruction\-Listener@{Set\-Destruction\-Listener}!b2World@{b2\-World}}
\subsubsection[{Set\-Destruction\-Listener}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf b2\-World\-::\-Set\-Destruction\-Listener} (
\begin{DoxyParamCaption}
\item[{{\bf b2\-Destruction\-Listener} $\ast$}]{listener}
\end{DoxyParamCaption}
)}}\label{classb2_world_ae377f2dd5512ada7d27f4ad3541c75bf}
Register a destruction listener. The listener is owned by you and must remain in scope. 
\begin{DoxyCode}
{
        m_destructionListener = listener;
}
\end{DoxyCode}
\hypertarget{classb2_world_a7a8eff61af98461f978fe43f3af7be90}{\index{b2\-World@{b2\-World}!Step@{Step}}
\index{Step@{Step}!b2World@{b2\-World}}
\subsubsection[{Step}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf b2\-World\-::\-Step} (
\begin{DoxyParamCaption}
\item[{float32}]{time\-Step, }
\item[{int32}]{velocity\-Iterations, }
\item[{int32}]{position\-Iterations}
\end{DoxyParamCaption}
)}}\label{classb2_world_a7a8eff61af98461f978fe43f3af7be90}
Take a time step. This performs collision detection, integration, and constraint solution. 
\begin{DoxyParams}{Parameters}
{\em time\-Step} & the amount of time to simulate, this should not vary. \\
\hline
{\em velocity\-Iterations} & for the velocity constraint solver. \\
\hline
{\em position\-Iterations} & for the position constraint solver. \\
\hline
\end{DoxyParams}

\begin{DoxyCode}
{
        b2Timer stepTimer;

        // If new fixtures were added, we need to find the new contacts.
        if (m_flags & e_newFixture)
        {
                m_contactManager.FindNewContacts();
                m_flags &= ~e_newFixture;
        }

        m_flags |= e_locked;

        b2TimeStep step;
        step.dt = dt;
        step.velocityIterations = velocityIterations;
        step.positionIterations = positionIterations;
        if (dt > 0.0f)
        {
                step.inv_dt = 1.0f / dt;
        }
        else
        {
                step.inv_dt = 0.0f;
        }

        step.dtRatio = m_inv_dt0 * dt;

        step.warmStarting = m_warmStarting;

        // Update contacts. This is where some contacts are destroyed.
        {
                b2Timer timer;
                m_contactManager.Collide();
                m_profile.collide = timer.GetMilliseconds();
        }

        // Integrate velocities, solve velocity constraints, and integrate
       positions.
        if (m_stepComplete && step.dt > 0.0f)
        {
                b2Timer timer;
                Solve(step);
                m_profile.solve = timer.GetMilliseconds();
        }

        // Handle TOI events.
        if (m_continuousPhysics && step.dt > 0.0f)
        {
                b2Timer timer;
                SolveTOI(step);
                m_profile.solveTOI = timer.GetMilliseconds();
        }

        if (step.dt > 0.0f)
        {
                m_inv_dt0 = step.inv_dt;
        }

        if (m_flags & e_clearForces)
        {
                ClearForces();
        }

        m_flags &= ~e_locked;

        m_profile.step = stepTimer.GetMilliseconds();
}
\end{DoxyCode}


The documentation for this class was generated from the following files\-:\begin{DoxyCompactItemize}
\item 
/\-Bing/\-File/cocos2d/cocos2d-\/iphone/cocos2d-\/iphone-\/2.\-1-\/beta4/external/\-Box2d/\-Box2\-D/\-Dynamics/b2\-World.\-h\item 
/\-Bing/\-File/cocos2d/cocos2d-\/iphone/cocos2d-\/iphone-\/2.\-1-\/beta4/external/\-Box2d/\-Box2\-D/\-Dynamics/b2\-World.\-cpp\end{DoxyCompactItemize}
